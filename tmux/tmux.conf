# reset prefix {{
unbind-key C-b

set-option -g prefix C-a
# <P><C-a> Send <Ctrl-a> to the program running in a tmux pane.
bind C-a send-prefix
# }}

# reset base index {{
set -g base-index 1
setw -g pane-base-index 1
set-option -g renumber-windows on
# }}

# source file
unbind r
bind-key r source-file ~/.config/tmux/tmux.conf \; display "Sourced!"

# default shell
set-option -g default-shell /bin/fish

# pane {{
# vi: select pane {{
# left
bind-key -r h select-pane -L
# down
bind-key -r j select-pane -D
# up
bind-key -r k select-pane -U
# right
bind-key -r l select-pane -R
# use `prefix q 2` to select a pane with the number 2
# }}

# arrow: select pane {{
bind-key Up    select-pane -U
bind-key Down  select-pane -D
bind-key Left  select-pane -L
bind-key Right select-pane -R
#}}

# split window(spawn pane) {{
#bind-key | split-window -h
#bind-key - split-window -v
bind-key v split-window -h -c "#{pane_current_path}"
bind-key s split-window -v -c "#{pane_current_path}"
# }}

# vi: resize pane {{
bind-key H resize-pane -L 12
bind-key J resize-pane -D 12
bind-key K resize-pane -U 12
bind-key L resize-pane -R 12
# }}

# select pane layout {{
bind-key = select-layout even-vertical
bind-key | select-layout even-horizontal
# }}

#bind P pipe-pane -o "cat >>~/#W.log" \; display "Toggled logging to ~/#W.log"

# allow programs in the pane to change the window name using a terminal escape sequence
#set-option -g allow-rename off

# Disable confirm before killing
#bind-key x kill-pane
# }}

# window {{
bind-key c new-window -c "#{pane_current_path}"

# automatically rename window {{
set-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'
# }}

# select window {{
# select previous window(`prefix ctrl-h`)
bind -r C-h select-window -t :-

# select next window(prefix ctrl-l)
bind -r C-l select-window -t :+

# use `prefix 2(number)` to select the second(number-th) window
# }}

# last-window
#bind-key L last-window

# swap-window {{
# Pressing Ctrl+Left (will move the current window to the left. Similarly
# right. No need to use the prefix (C-b).
bind-key -n C-Left swap-window -t -1
bind-key -n C-Right swap-window -t +1
# }}

# Sync panes (Send input to all panes in the window). When enabled, pane
# borders become red as an indication.
bind C-s if -F '#{pane_synchronized}' \
                     'setw synchronize-panes off; \
                      setw pane-active-border-style fg=colour63,bg=default; \
                      setw pane-border-format       " #P "' \
                   'setw synchronize-panes on; \
                    setw pane-active-border-style fg=red; \
                    setw pane-border-format       " #P - Pane Synchronization ON "'

# if multiple clients are attached to the same window, maximize it to the bigger
# one
set-window-option -g aggressive-resize
# }}

# session {{
# select session {{
# previous session
bind ( switch-client -p
# next session
bind ) switch-client -n
# }}
# }}

# copy mode {{
bind Escape copy-mode

set-window-option -g mode-keys vi

# Enter copy mode with /
bind-key / copy-mode \; send-key ?

unbind -T copy-mode-vi Enter
unbind -T copy-mode-vi Space

# setup 'v' to begin selection as in Vim
bind-key -T copy-mode-vi 'v' send-keys -X begin-selection

# copy text with `y` in copy mode
bind-key -T copy-mode-vi 'y' send-keys -X copy-selection-and-cancel

bind-key -T edit-mode-vi Up send-keys -X history-up
bind-key -T edit-mode-vi Down send-keys -X history-down

# copy text with mouse selection without pressing any key
bind-key -T copy-mode-vi MouseDragEnd1Pane send -X copy-selection-and-cancel

unbind p
bind p paste-buffer

# history-limit
set -g history-limit 30000

# clear-history
bind-key -n C-k clear-history

# emacs key bindings in tmux command prompt (prefix + :) are better than
# vi keys, even for vim users
set -g status-keys emacs
#set-option -g status-keys vi

# word separators for automatic word selection
setw -g word-separators ' @"=()[]_-:,.'
setw -ag word-separators "'"
# }}

# terminal feature {{
# change the default $TERM - xterm-256color / tmux-256color / screen-256color
set -g default-terminal "xterm-256color"

# enable RGB colour if running in xterm(1)
#set-option -sa terminal-overrides ",xterm-256color*:Tc"
set -ga terminal-overrides ",xterm-256color*:Tc:clipboard"
set -ga terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'

set -g set-clipboard on

bind C-x run "tmux show-buffer | xsel -i -b"

# Set title
set -g set-titles on
set -g set-titles-string "#T"
# }}

# event {{
# focus events enabled for terminals that support them
set-option -g focus-events on

# enable mouse control
set -g mouse on

# escape-time
set -sg escape-time 0

# repeat-time
set -g repeat-time 200

# Show times longer than supposed
set -g display-panes-time 2000

# tmux messages are displayed for 4 seconds
set -g display-time 4000

# By default, tmux refreshes the status line every 15 seconds.
set -g status-interval 50

# activity alert {{
# enable activity alerts in other windows.
# highlight the window name in the status line when there's activity in that window
setw -g monitor-activity on
set -g visual-activity on # show a message in the status line
#setw -g window-status-activity-style ...
# }}
# }}

#source-file ~/.config/tmux/tmux-dark.conf
source-file ~/.config/tmux/tmux-light.conf

# vim: foldmarker={{,}} fdm=marker
